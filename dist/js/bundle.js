!function(e){"use strict";function t(e,t){return t={exports:{}},e(t,t.exports),t.exports}function i(e,t,i){var n=i.get("codemirrorOptions")||{};n.value=ko.unwrap(t());var o=CodeMirror(e,n);o.on("change",function(e){var i=t();i(e.getValue())}),e.editor=o}function n(e,t){var i=ko.unwrap(t());if(e.editor){var n=i!==e.editor.getValue();n&&(e.editor.setValue(i),e.editor.refresh())}}function o(){ko.bindingHandlers.codemirror={init:i,update:n}}function s(e){return y(b(e))}function r(e){return v(e)}function a(e){return"[1m[31m"+e+"[39m[22m"}function c(e){return"[1m[32m"+e+"[39m[22m"}function u(e){return"[90m"+e+"[39m"}function h(e,t){var i=e.getBoundingClientRect(),n=t.getBoundingClientRect();return i.top>=n.top&&i.left>=n.left&&i.bottom<=n.bottom&&i.right<=n.right}var l={};l.classCallCheck=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},l.createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),l.inherits=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},l.possibleConstructorReturn=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},l.toArray=function(e){return Array.isArray(e)?e:Array.from(e)};var d={register:o},f=t(function(e){!function(t,i){function n(){this.fg=this.bg=this.fg_truecolor=this.bg_truecolor=null,this.bright=0}var o,s,r="undefined"!=typeof e,a=[[{color:"0, 0, 0","class":"ansi-black"},{color:"187, 0, 0","class":"ansi-red"},{color:"0, 187, 0","class":"ansi-green"},{color:"187, 187, 0","class":"ansi-yellow"},{color:"0, 0, 187","class":"ansi-blue"},{color:"187, 0, 187","class":"ansi-magenta"},{color:"0, 187, 187","class":"ansi-cyan"},{color:"255,255,255","class":"ansi-white"}],[{color:"85, 85, 85","class":"ansi-bright-black"},{color:"255, 85, 85","class":"ansi-bright-red"},{color:"0, 255, 0","class":"ansi-bright-green"},{color:"255, 255, 85","class":"ansi-bright-yellow"},{color:"85, 85, 255","class":"ansi-bright-blue"},{color:"255, 85, 255","class":"ansi-bright-magenta"},{color:"85, 255, 255","class":"ansi-bright-cyan"},{color:"255, 255, 255","class":"ansi-bright-white"}]];n.prototype.setup_palette=function(){s=[],function(){var e,t;for(e=0;2>e;++e)for(t=0;8>t;++t)s.push(a[e][t].color)}(),function(){var e,t,i,n=[0,95,135,175,215,255],o=function(e,t,i){return n[e]+", "+n[t]+", "+n[i]};for(e=0;6>e;++e)for(t=0;6>t;++t)for(i=0;6>i;++i)s.push(o.call(this,e,t,i))}(),function(){var e,t=8,i=function(e){return e+", "+e+", "+e};for(e=0;24>e;++e,t+=10)s.push(i.call(this,t))}()},n.prototype.escape_for_html=function(e){return e.replace(/[&<>]/gm,function(e){return"&"==e?"&amp;":"<"==e?"&lt;":">"==e?"&gt;":void 0})},n.prototype.linkify=function(e){return e.replace(/(https?:\/\/[^\s]+)/gm,function(e){return'<a href="'+e+'">'+e+"</a>"})},n.prototype.ansi_to_html=function(e,t){return this.process(e,t,!0)},n.prototype.ansi_to_text=function(e){var t={};return this.process(e,t,!1)},n.prototype.process=function(e,t,i){var n=this,o=e.split(/\033\[/),s=o.shift(),r=o.map(function(e){return n.process_chunk(e,t,i)});return r.unshift(s),r.join("")},n.prototype.process_chunk=function(e,t,i){t="undefined"==typeof t?{}:t;var n="undefined"!=typeof t.use_classes&&t.use_classes,o=n?"class":"color",r=e.match(/^([!\x3c-\x3f]*)([\d;]*)([\x20-\x2c]*[\x40-\x7e])([\s\S]*)/m);if(!r)return e;var c=r[4],u=r[2].split(";");if(""!==r[1]||"m"!==r[3])return c;if(!i)return c;for(var h=this;u.length>0;){var l=u.shift(),d=parseInt(l);isNaN(d)||0===d?(h.fg=h.bg=null,h.bright=0):1===d?h.bright=1:39==d?h.fg=null:49==d?h.bg=null:d>=30&&38>d?h.fg=a[h.bright][d%10][o]:d>=90&&98>d?h.fg=a[1][d%10][o]:d>=40&&48>d?h.bg=a[0][d%10][o]:d>=100&&108>d?h.bg=a[1][d%10][o]:38!==d&&48!==d||!function(){var e=38===d;if(u.length>=1){var t=u.shift();if("5"===t&&u.length>=1){var i=parseInt(u.shift());if(i>=0&&255>=i)if(n){var o=i>=16?"ansi-palette-"+i:a[i>7?1:0][i%8]["class"];e?h.fg=o:h.bg=o}else s||h.setup_palette.call(h),e?h.fg=s[i]:h.bg=s[i]}else if("2"===t&&u.length>=3){var r=parseInt(u.shift()),c=parseInt(u.shift()),l=parseInt(u.shift());if(r>=0&&255>=r&&c>=0&&255>=c&&l>=0&&255>=l){var f=r+", "+c+", "+l;n?e?(h.fg="ansi-truecolor",h.fg_truecolor=f):(h.bg="ansi-truecolor",h.bg_truecolor=f):e?h.fg=f:h.bg=f}}}}()}if(null===h.fg&&null===h.bg)return c;var f=[],p=[],b={},v=function(e){var t,i=[];for(t in e)e.hasOwnProperty(t)&&i.push("data-"+t+'="'+this.escape_for_html(e[t])+'"');return i.length>0?" "+i.join(" "):""};return h.fg&&(n?(p.push(h.fg+"-fg"),null!==h.fg_truecolor&&(b["ansi-truecolor-fg"]=h.fg_truecolor,h.fg_truecolor=null)):f.push("color:rgb("+h.fg+")")),h.bg&&(n?(p.push(h.bg+"-bg"),null!==h.bg_truecolor&&(b["ansi-truecolor-bg"]=h.bg_truecolor,h.bg_truecolor=null)):f.push("background-color:rgb("+h.bg+")")),n?'<span class="'+p.join(" ")+'"'+v.call(h,b)+">"+c+"</span>":'<span style="'+f.join(";")+'"'+v.call(h,b)+">"+c+"</span>"},o={escape_for_html:function(e){var t=new n;return t.escape_for_html(e)},linkify:function(e){var t=new n;return t.linkify(e)},ansi_to_html:function(e,t){var i=new n;return i.ansi_to_html(e,t)},ansi_to_text:function(e){var t=new n;return t.ansi_to_text(e)},ansi_to_html_obj:function(){return new n}},r&&(e.exports=o),"undefined"!=typeof window&&"undefined"==typeof ender&&(window.ansi_up=o),"function"==typeof define&&define.amd&&define("ansi_up",[],function(){return o})}(Date)}),p=f&&"object"==typeof f&&"default"in f?f["default"]:f,b=p.ansi_to_html,v=p.escape_for_html,y=p.linkify,m=ko,k=m.observable,g=m.observableArray,w=m.computed,C=function(){function e(t){var i=this;l.classCallCheck(this,e),this.$body=document.querySelector("body"),this.parentViewModel=t,this.socket=io.connect(SERVER_URI),this.history=[],this.inputCallback=null,this.lines=g([]),this.command=k(""),this.inputType=k("text"),this.promptStr=k(""),this.maxLines=k(1e3),this.maxHistory=k(1e3),this.echo=k(!1),this.space=k(!1),this.inputHasFocus=k(!0),this.promptFormatted=w(function(){return s(r(i.composedPrompt()))}),this.maxLines.subscribe(function(e){i.lines().length>e&&i.truncateLines()}),this.maxHistory.subscribe(function(e){history().length>e&&i.truncateHistory()}),this.socket.on("connect",this.onConnect.bind(this)),this.socket.on("connecting",this.onConnecting.bind(this)),this.socket.on("disconnect",this.onDisconnect.bind(this)),this.socket.on("connect_failed",this.onConnectFailed.bind(this)),this.socket.on("error",this.onError.bind(this)),this.socket.on("reconnect_failed",this.onReconnectFailed.bind(this)),this.socket.on("reconnect",this.onReconnect.bind(this)),this.socket.on("reconnecting",this.onReconnecting.bind(this)),this.socket.on("output",this.onOutput.bind(this)),this.socket.on("set-prompt",this.onSetPrompt.bind(this)),this.socket.on("request-input",this.onRequestInput.bind(this)),this.socket.on("edit-verb",this.onEditVerb.bind(this)),this.socket.on("edit-function",this.onEditFunction.bind(this)),this.addLine(u("Connecting..."))}return l.createClass(e,[{key:"composedPrompt",value:function(){var e=arguments.length<=0||void 0===arguments[0]?"":arguments[0];return(this.promptStr()+" > "+e).trim()}},{key:"setPrompt",value:function(e,t){this.promptStr(e),t&&this.inputType(t)}},{key:"sendCommand",value:function(){var e=this.command().trim();e&&(this.echoCommand(e),this.addToHistory(e),this.handleClientCommand(e)||(this.socket.connected?this.inputCallback?this.handleInputCallback(e):this.socket.emit("input",e):this.addLine(a("Not connected."))),this.command(""))}},{key:"echoCommand",value:function(e){this.echo()&&"password"!==this.inputType()&&(this.addLine(this.composedPrompt(e)),this.space()&&this.addLine(" "))}},{key:"addToHistory",value:function(e){"password"!==this.inputType()&&(this.history.unshift(e),this.history.length>this.maxHistory()&&this.truncateHistory(),this.currentHistory=-1)}},{key:"handleClientCommand",value:function(e){switch(e){case".clear":return this.lines([]),!0;case".connect":return this.reconnectSocket(),!0;case".disconnect":return this.disconnectSocket(),!0;case".echo on":return this.echo(!0),!0;case".echo off":return this.echo(!1),!0;case".space on":return this.space(!0),!0;case".space off":return this.space(!1),!0;case".new tab":return this.parentViewModel.parentViewModel.newClientTab(),!0;case".close tab":return this.parentViewModel.close(),!0;default:return!1}}},{key:"handleInputCallback",value:function(e){var t=this.inputCallback;this.inputCallback=null,t(e)}},{key:"addLine",value:function(e){this.lines.push(s(r(e))),this.scrollToBottom()}},{key:"addLines",value:function(e){var t=this;e.forEach(function(e){t.addLine(e)})}},{key:"disconnectSocket",value:function(){this.socket.connected?this.socket.disconnect():this.addLine(a("Not connected."))}},{key:"reconnectSocket",value:function(){this.socket.connected?this.addLine(a("Already connected.")):this.socket.connect()}},{key:"scrollToBottom",value:function(){this.$body.scrollTop=this.$body.scrollHeight-window.innerHeight}},{key:"truncateHistory",value:function(){this.history=this.history.slice(0,this.maxHistory())}},{key:"truncateLines",value:function(){var e=this.lines().length-this.maxLines();this.lines(this.lines.slice(e))}},{key:"willClose",value:function(){return this.socket.disconnect(),!0}},{key:"onKeyDown",value:function(e,t){var i="undefined"==typeof t.which?t.keyCode:t.which,n=t.metaKey,o=t.ctrlKey,s=t.shiftKey,r=86===i,a=38===i,c=40===i,u=9===i;if(n&&!r||o&&!r)return!0;if(!this.inputHasFocus()&&(this.inputHasFocus(!0),a||c))return this.onRecall(null,{which:i});if(u){var h=s?-1:1;return this.socket.emit("tab-key-press",{direction:h}),!1}return!0}},{key:"onRecall",value:function(e,t){var i="undefined"==typeof t.which?t.keyCode:t.which;if(0===this.history.length)return!0;switch(i){case 38:return this.currentHistory<this.history.length-1&&this.currentHistory++,this.command(this.history[this.currentHistory]),!1;case 40:this.currentHistory>-1&&this.currentHistory--,this.currentHistory>=0?this.command(this.history[this.currentHistory]):this.command("")}return!0}},{key:"onConnect",value:function(){this.addLine(c("Connected!"))}},{key:"onConnecting",value:function(){this.addLine(u("Connecting..."))}},{key:"onDisconnect",value:function(){this.addLine(a("Disconnected from server.")),this.setPrompt(""),this.inputCallback=null}},{key:"onConnectFailed",value:function(){this.addLine(a("Connection to server failed."))}},{key:"onError",value:function(){this.addLine(a("An unknown error occurred."))}},{key:"onReconnectFailed",value:function(){this.addLine(a("Unable to reconnect to server."))}},{key:"onReconnect",value:function(){}},{key:"onReconnecting",value:function(){}},{key:"onOutput",value:function(e){var t=e.split("\n");this.addLines(t),this.space()&&this.addLine(" ")}},{key:"onSetPrompt",value:function(e){this.setPrompt(e)}},{key:"onEditVerb",value:function(e){this.parentViewModel.parentViewModel.newEditVerbTab(this.socket,e)}},{key:"onEditFunction",value:function(e){this.parentViewModel.parentViewModel.newEditFunctionTab(this.socket,e)}},{key:"onRequestInput",value:function(e,t){var i=this,n=this.promptStr();this.getInputFromUser({},e,function(e){i.setPrompt(n,"text"),t(e)})}},{key:"getInputFromUser",value:function(e,t,i){var n=this;if(0===t.length)return void i(e);var o=l.toArray(t),s=o[0],r=o.slice(1);this.setPrompt(s.label||"input",s.type||"text"),this.inputCallback=function(t){e[s.name||"input"]=t,n.getInputFromUser(e,r,i)}}}]),e}(),_=function(){function e(t){l.classCallCheck(this,e),this.parentViewModel=t,this.templateId="client",this.viewModel=new C(this),this.dirty=!1,this.name=ko.observable("Room.js"),this.active=ko.computed(this.computeActive.bind(this))}return l.createClass(e,[{key:"templateBinding",value:function(){return{name:this.templateId,data:this.viewModel}}},{key:"computeActive",value:function(){return this.parentViewModel.activeTab()===this}},{key:"select",value:function(){this.parentViewModel.activeTab(this),this.viewModel.scrollToBottom(),this.viewModel.inputHasFocus(!0)}},{key:"close",value:function(){this.viewModel.willClose()&&this.parentViewModel.closeTab(this)}},{key:"tabPaneClasses",value:function(){return["tab-pane-client"]}},{key:"hideIfOnlyMe",value:function(){return!0}}]),e}(),M=function(){function e(t,i,n){var o=n.verb,s=n.objectId;l.classCallCheck(this,e),this.parentViewModel=t,this.socket=i,this.objectId=s,this.name=o.name,this.codemirrorOptions={lineNumbers:!0,theme:"tomorrow-night-bright",tabSize:2,indentWithTabs:!1,extraKeys:{Tab:function(e){return e.doc.somethingSelected()?CodeMirror.Pass:e.execCommand("insertSoftTab")}}},this.pattern=ko.observable(o.pattern),this.dobjarg=ko.observable(o.dobjarg),this.preparg=ko.observable(o.preparg),this.iobjarg=ko.observable(o.iobjarg),this.code=ko.observable(o.code),this._pattern=ko.observable(o.pattern),this._dobjarg=ko.observable(o.dobjarg),this._preparg=ko.observable(o.preparg),this._iobjarg=ko.observable(o.iobjarg),this._code=ko.observable(o.code),this.dirty=ko.computed(this.computeDirty.bind(this))}return l.createClass(e,[{key:"computeDirty",value:function(){return this.pattern()!==this._pattern()||this.dobjarg()!==this._dobjarg()||this.preparg()!==this._preparg()||this.iobjarg()!==this._iobjarg()||this.code()!==this._code()}},{key:"save",value:function(){var e=this,t={name:this.name,pattern:this.pattern(),dobjarg:this.dobjarg(),preparg:this.preparg(),iobjarg:this.iobjarg(),code:this.code()},i={objectId:this.objectId,verb:t};return this.socket.connected?void this.socket.emit("save-verb",i,function(t){"saved"===t?(e._pattern(e.pattern()),e._dobjarg(e.dobjarg()),e._preparg(e.preparg()),e._iobjarg(e.iobjarg()),e._code(e.code())):window.alert(t)}):void window.alert(["The client tab that this editor was opened from has been","closed.  You must keep that open for saving to work."].join(" "))}},{key:"willClose",value:function(){var e=["Are you sure you want to close this tab?","You have unsaved changes that will be lost."].join(" ");return this.dirty()?window.confirm(e):!0}},{key:"onKeyDown",value:function(e,t){var i="undefined"==typeof t.which?t.keyCode:t.which,n=t.metaKey,o=t.ctrlKey,s=83===i,r=87===i;return o&&s||n&&s?(this.save(),!1):o&&r||n&&r?(this.parentViewModel.close(),!1):!0}}]),e}(),j=function(){function e(t,i,n){var o=this;l.classCallCheck(this,e),this.parentViewModel=t,this.templateId="verb-editor",this.viewModel=new M(this,i,n),this.name=ko.observable(n.objectId+"."+n.verb.name),this.active=ko.computed(function(){return t.activeTab()===o}),this.dirty=ko.computed(function(){return o.viewModel.dirty()})}return l.createClass(e,[{key:"templateBinding",value:function(){return{name:this.templateId,data:this.viewModel}}},{key:"select",value:function(){this.parentViewModel.activeTab(this)}},{key:"close",value:function(){this.viewModel.willClose()&&this.parentViewModel.closeTab(this)}},{key:"tabPaneClasses",value:function(){return["tab-pane-editor","tab-pane-verb-editor"]}},{key:"hideIfOnlyMe",value:function(){return!1}}]),e}(),I=function(){function e(t,i,n){var o=this,s=n.objectId,r=n.src,a=n.name;l.classCallCheck(this,e),this.parentViewModel=t,this.socket=i,this.objectId=s,this.src=r,this.name=a,this.codemirrorOptions={lineNumbers:!0,theme:"tomorrow-night-bright",tabSize:2,indentWithTabs:!1,extraKeys:{Tab:function(e){return e.doc.somethingSelected()?CodeMirror.Pass:e.execCommand("insertSoftTab")}}},this.code=ko.observable(this.src),this._code=ko.observable(this.src),this.dirty=ko.computed(function(){return o.code()!==o._code()})}return l.createClass(e,[{key:"save",value:function(){var e=this,t={name:this.name,src:this.code(),objectId:this.objectId};return this.socket.connected?void this.socket.emit("save-function",t,function(t){"saved"===t?e._code(e.code()):window.alert(t)}):void window.alert(["The client tab that this editor was opened from has been","closed.  You must keep that open for saving to work."].join(" "))}},{key:"willClose",value:function(){var e=["Are you sure you want to close this tab?","You have unsaved changes that will be lost."].join(" ");return this.dirty()?window.confirm(e):!0}},{key:"onKeyDown",value:function(e,t){var i="undefined"==typeof t.which?t.keyCode:t.which,n=t.metaKey,o=t.ctrlKey,s=83===i,r=87===i;return o&&s||n&&s?(this.save(),!1):o&&r||n&&r?(this.parentViewModel.close(),!1):!0}}]),e}(),V=function(){function e(t,i,n){var o=this;l.classCallCheck(this,e),this.parentViewModel=t,this.templateId="function-editor",this.viewModel=new I(this,i,n),this.name=ko.observable(n.objectId+"."+n.name),this.active=ko.computed(function(){return t.activeTab()===o}),this.dirty=ko.computed(function(){return o.viewModel.dirty()})}return l.createClass(e,[{key:"templateBinding",value:function(){return{name:this.templateId,data:this.viewModel}}},{key:"select",value:function(){this.parentViewModel.activeTab(this)}},{key:"close",value:function(){this.viewModel.willClose()&&this.parentViewModel.closeTab(this)}},{key:"tabPaneClasses",value:function(){return["tab-pane-editor","tab-pane-function-editor"]}},{key:"hideIfOnlyMe",value:function(){return!1}}]),e}(),T=function(){function e(t){l.classCallCheck(this,e),this.data=t,this.objectId=t.objectId,this.active=ko.observable(!1),this.name=ko.computed(this.computeName.bind(this))}return l.createClass(e,[{key:"computeName",value:function(){throw new Error("Must be subclassed.")}},{key:"openEditor",value:function(){throw new Error("Must be subclassed.")}}],[{key:"newFromResult",value:function(e){if(e["function"])return new x(e);if(e.verb)return new R(e);throw new Error("Invalid result type.")}}]),e}(),x=function(e){function t(){return l.classCallCheck(this,t),l.possibleConstructorReturn(this,Object.getPrototypeOf(t).apply(this,arguments))}return l.inherits(t,e),l.createClass(t,[{key:"computeName",value:function(){return this.objectId+"."+this.data["function"]}},{key:"openEditor",value:function(e,t){var i={objectId:this.objectId,name:this.data["function"]};e.emit("get-function",i,function(i){t.newEditFunctionTab(e,i)})}}]),t}(T),R=function(e){function t(){return l.classCallCheck(this,t),l.possibleConstructorReturn(this,Object.getPrototypeOf(t).apply(this,arguments))}return l.inherits(t,e),l.createClass(t,[{key:"computeName",value:function(){return this.objectId+"."+this.data.verb}},{key:"openEditor",value:function(e,t){var i={objectId:this.objectId,name:this.data.verb};e.emit("get-verb",i,function(i){t.newEditVerbTab(e,i)})}}]),t}(T),S=function(){function e(t,i){var n=this;l.classCallCheck(this,e),this.parentViewModel=t,this.socket=i,this.inputHasFocus=!0,this.search=ko.observable(""),this.results=ko.observableArray(),this.selectedIndex=ko.observable(0),this.selectionDirection=ko.observable(0),this.search.subscribe(this.onSearch.bind(this)),this.activeResult=ko.computed(this.computeActiveResult.bind(this)),this.hasResults=ko.computed(function(){return n.results().length>0})}return l.createClass(e,[{key:"computeActiveResult",value:function(){var e=this.results(),t=this.selectedIndex();return e.length>0?(e.forEach(function(e){e.active(!1)}),e[t].active(!0),this.scrollActiveResultIntoView(),e[t]):null}},{key:"scrollActiveResultIntoView",value:function(){var e=document.querySelector(".search .results li.active"),t=document.querySelector(".search .results");e&&!h(e,t)&&e.scrollIntoView(-1===this.selectionDirection())}},{key:"close",value:function(){this.parentViewModel.searchViewModel(null)}},{key:"openActiveResult",value:function(){var e=this.activeResult();e.openEditor(this.socket,this.parentViewModel)}},{key:"onSearch",value:function(e){var t=this;this.socket.emit("search",e,function(e){t.selectedIndex(0),t.results(e.map(function(e){return T.newFromResult(e)}))})}},{key:"onKeyDown",value:function(e,t){var i="undefined"==typeof t.which?t.keyCode:t.which,n=this.selectedIndex();switch(i){case 13:return this.openActiveResult(),this.close(),!1;case 27:return this.close(),!1;case 38:return n>0?this.selectedIndex(n-1):this.selectedIndex(this.results().length-1),this.selectionDirection(-1),!1;case 40:return n<this.results().length-1?this.selectedIndex(n+1):this.selectedIndex(0),this.selectionDirection(1),!1;default:return!0}}}]),e}(),H=function(){function e(){l.classCallCheck(this,e),this.activeTab=ko.observable(),this.tabs=ko.observableArray([new _(this)]),this.searchViewModel=ko.observable(),this.activeViewModel=ko.computed(this.computeActiveViewModel.bind(this)),this.hidden=ko.computed(this.computeHidden.bind(this)),this.visible=ko.computed(this.computeVisible.bind(this)),this.tabPaneClasses=ko.computed(this.computeTabPaneClasses.bind(this)),this.templateBinding=ko.computed(this.computeTemplateBinding.bind(this)),this.activeSocket=ko.computed(this.computeActiveSocket.bind(this)),this.activeTab(this.tabs()[0])}return l.createClass(e,[{key:"computeActiveViewModel",value:function(){var e=this.searchViewModel();if(e)return e;var t=this.activeTab();return t?t.viewModel:this}},{key:"computeHidden",value:function(){var e=this.tabs().length,t=this.tabs()[0];return 0===e||1===e&&t.hideIfOnlyMe()}},{key:"computeVisible",value:function(){return!this.hidden()}},{key:"computeTabPaneClasses",value:function(){var e=this.activeTab(),t=void 0;return t=e?e.tabPaneClasses():[],this.visible()&&t.push("tabs-visible"),t.join(" ")}},{key:"computeTemplateBinding",value:function(){var e=this.activeTab();return e?e.templateBinding():{name:"no-tabs",data:this}}},{key:"computeActiveSocket",value:function(){var e=this.activeViewModel();return e.socket}},{key:"tabPaneClasses",value:function(){return[]}},{key:"newClientTab",value:function(){var e=new _(this);this.tabs.push(e),e.select()}},{key:"newEditVerbTab",value:function(e,t){var i=new j(this,e,t);this.tabs.push(i),i.select()}},{key:"newEditFunctionTab",value:function(e,t){var i=new V(this,e,t);this.tabs.push(i),i.select()}},{key:"closeTab",value:function(e){var t=this.tabs().length-1,i=this.tabs.indexOf(e);i===t&&i--,this.tabs.remove(e),t>0?this.tabs()[i].select():this.activeTab(null)}},{key:"onKeyDown",value:function(){var e=this.activeViewModel(),t="undefined"==typeof event.which?event.keyCode:event.which,i=event.metaKey,n=event.ctrlKey,o=80===t;if(i&&o||n&&o)return this.searchViewModel()||this.searchViewModel(new S(this,this.activeSocket())),!1;if(e&&e.onKeyDown){for(var s=arguments.length,r=Array(s),a=0;s>a;a++)r[a]=arguments[a];return e.onKeyDown.apply(e,r)}return!0}},{key:"onKeyUp",value:function(){var e=this.activeViewModel();if(e&&e.onKeyUp){for(var t=arguments.length,i=Array(t),n=0;t>n;n++)i[n]=arguments[n];return e.onKeyUp.apply(e,i)}return!0}}]),e}();d.register(),e.TabsViewModel=H}(this.bundle=this.bundle||{});