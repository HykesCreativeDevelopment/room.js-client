{"version":3,"file":"bundle.js","sources":["../../src/lib/ko-codemirror.js","../../src/lib/ko-uncloak.js","../../src/lib/colors.js","../../src/view-models/search-view-model.js","../../src/lib/add-sane-on-unload-handler.js","../../node_modules/ansi_up/ansi_up.js","../../src/view-models/client-view-model.js","../../src/view-models/client-tab-view-model.js","../../src/view-models/verb-editor-view-model.js","../../src/view-models/verb-editor-tab-view-model.js","../../src/view-models/function-editor-view-model.js","../../src/view-models/function-editor-tab-view-model.js","../../src/view-models/tabs-view-model.js"],"sourcesContent":["function register (ko, CodeMirror) {\n  function init (element, valueAccessor, allBindings) {\n    const options = allBindings.get('codemirrorOptions') || {}\n    options.value = ko.unwrap(valueAccessor())\n    const editor = CodeMirror(element, options) // eslint-disable-line new-cap\n\n    editor.on('change', cm => {\n      const value = valueAccessor()\n      value(cm.getValue())\n    })\n\n    element.editor = editor\n  }\n\n  function update (element, valueAccessor) {\n    const observedValue = ko.unwrap(valueAccessor())\n\n    if (element.editor) {\n      const changed = observedValue !== element.editor.getValue()\n\n      if (changed) {\n        element.editor.setValue(observedValue)\n        element.editor.refresh()\n      }\n    }\n  }\n\n  ko.bindingHandlers.codemirror = { init, update }\n}\n\nexport default { register }\n","function register (ko) {\n  function init (element) {\n    element.classList.remove('cloak')\n  }\n\n  ko.bindingHandlers.uncloak = { init }\n}\n\nexport default { register }\n","export function boldRed (str) {\n  return `\\u001b[1m\\u001b[31m${str}\\u001b[39m\\u001b[22m`\n}\n\nexport function boldGreen (str) {\n  return `\\u001b[1m\\u001b[32m${str}\\u001b[39m\\u001b[22m`\n}\n\nexport function gray (str) {\n  return `\\u001b[90m${str}\\u001b[39m`\n}\n","function isElementVisibleIn (el, container) {\n  const elRect = el.getBoundingClientRect()\n  const containerRect = container.getBoundingClientRect()\n\n  return (\n    elRect.top >= containerRect.top &&\n    elRect.left >= containerRect.left &&\n    elRect.bottom <= containerRect.bottom &&\n    elRect.right <= containerRect.right\n  )\n}\n\nclass SearchResult {\n  constructor (ko, data) {\n    this.data = data\n    this.objectId = data.objectId\n    this.active = ko.observable(false)\n    this.name = ko.computed(this.computeName.bind(this))\n  }\n\n  static newFromResult (ko, result) {\n    if (result.function) {\n      // eslint-disable-next-line no-use-before-define\n      return new FunctionSearchResult(ko, result)\n    } else if (result.verb) {\n      // eslint-disable-next-line no-use-before-define\n      return new VerbSearchResult(ko, result)\n    }\n    throw new Error('Invalid result type.')\n  }\n\n  computeName () {\n    throw new Error('Must be subclassed.')\n  }\n\n  openEditor () {\n    throw new Error('Must be subclassed.')\n  }\n}\n\nclass FunctionSearchResult extends SearchResult {\n  computeName () {\n    return `${this.objectId}.${this.data.function}`\n  }\n\n  openEditor (socket, tabsViewModel) {\n    const params = { objectId: this.objectId, name: this.data.function }\n    socket.emit('get-function', params, data => {\n      tabsViewModel.newEditFunctionTab(socket, data)\n    })\n  }\n}\n\nclass VerbSearchResult extends SearchResult {\n  computeName () {\n    return `${this.objectId}.${this.data.verb}`\n  }\n\n  openEditor (socket, tabsViewModel) {\n    const params = { objectId: this.objectId, name: this.data.verb }\n    socket.emit('get-verb', params, data => {\n      tabsViewModel.newEditVerbTab(socket, data)\n    })\n  }\n}\n\n// TODO: socket permissions\nexport default class SearchViewModel {\n  constructor ({ doc, ko }, parentViewModel, socket) {\n    this.document = doc\n    this.ko = ko\n    this.parentViewModel = parentViewModel\n    this.socket = socket\n    this.inputHasFocus = true\n\n    this.search = ko.observable('')\n    this.results = ko.observableArray([])\n    this.selectedIndex = ko.observable(0)\n    this.selectionDirection = ko.observable(0)\n\n    this.search.subscribe(this.onSearch.bind(this))\n\n    this.activeResult = ko.computed(this.computeActiveResult.bind(this))\n    this.hasResults = ko.computed(() => this.results().length > 0)\n  }\n\n  computeActiveResult () {\n    const results = this.results()\n    const selectedIndex = this.selectedIndex()\n\n    if (results.length > 0) {\n      results.forEach(result => { result.active(false) })\n      results[selectedIndex].active(true)\n      this.scrollActiveResultIntoView()\n      return results[selectedIndex]\n    }\n    return null\n  }\n\n  scrollActiveResultIntoView () {\n    const el = this.document.querySelector('.search .results li.active')\n    const container = this.document.querySelector('.search .results')\n    if (el && !isElementVisibleIn(el, container)) {\n      el.scrollIntoView(this.selectionDirection() === -1)\n    }\n  }\n\n  close () {\n    this.parentViewModel.searchViewModel(null)\n  }\n\n  openActiveResult () {\n    const activeResult = this.activeResult()\n    activeResult.openEditor(this.socket, this.parentViewModel)\n  }\n\n  onSearch (str) {\n    this.socket.emit('search', str, results => {\n      this.selectedIndex(0)\n      this.results(results.map(result => SearchResult.newFromResult(this.ko, result)))\n    })\n  }\n\n  onKeyDown (_, event) {\n    const key = typeof event.which === 'undefined' ? event.keyCode : event.which\n    const selectedIndex = this.selectedIndex()\n\n    switch (key) {\n      case 13: { // enter key\n        this.openActiveResult()\n        this.close()\n        return false\n      }\n      case 27: { // esc key\n        this.close()\n        return false\n      }\n      case 38: { // up key\n        if (selectedIndex > 0) {\n          this.selectedIndex(selectedIndex - 1)\n        } else {\n          this.selectedIndex(this.results().length - 1)\n        }\n        this.selectionDirection(-1)\n        return false\n      }\n      case 40: { // down key\n        if (selectedIndex < this.results().length - 1) {\n          this.selectedIndex(selectedIndex + 1)\n        } else {\n          this.selectedIndex(0)\n        }\n        this.selectionDirection(1)\n        return false\n      }\n      default: {\n        return true\n      }\n    }\n  }\n}\n","// Credit: http://stackoverflow.com/users/39013/josiah-ruddell\n// http://stackoverflow.com/questions/4126820/window-onbeforeunload-may-fire-multiple-times\n\nconst NAVIGATE_AWAY_MESSAGE = 'This action will log you out of the game!'\n\nexport default function addSaneOnUnloadHandler (win, promptBeforeLeaving = () => true) {\n  let alreadPrompted = false\n  let timeoutID = 0\n\n  const reset = () => {\n    alreadPrompted = false\n    timeoutID = 0\n  }\n\n  win.onbeforeunload = () => {\n    if (promptBeforeLeaving() && !alreadPrompted) {\n      alreadPrompted = true\n      timeoutID = setTimeout(reset, 100)\n      return NAVIGATE_AWAY_MESSAGE\n    }\n    return null\n  }\n\n  win.onunload = () => {\n    clearTimeout(timeoutID)\n  }\n}\n","// ansi_up.js\n// version : 1.3.0\n// author : Dru Nelson\n// license : MIT\n// http://github.com/drudru/ansi_up\n\n(function (Date, undefined) {\n\n    var ansi_up,\n        VERSION = \"1.3.0\",\n\n        // check for nodeJS\n        hasModule = (typeof module !== 'undefined'),\n\n        // Normal and then Bright\n        ANSI_COLORS = [\n          [\n            { color: \"0, 0, 0\",        'class': \"ansi-black\"   },\n            { color: \"187, 0, 0\",      'class': \"ansi-red\"     },\n            { color: \"0, 187, 0\",      'class': \"ansi-green\"   },\n            { color: \"187, 187, 0\",    'class': \"ansi-yellow\"  },\n            { color: \"0, 0, 187\",      'class': \"ansi-blue\"    },\n            { color: \"187, 0, 187\",    'class': \"ansi-magenta\" },\n            { color: \"0, 187, 187\",    'class': \"ansi-cyan\"    },\n            { color: \"255,255,255\",    'class': \"ansi-white\"   }\n          ],\n          [\n            { color: \"85, 85, 85\",     'class': \"ansi-bright-black\"   },\n            { color: \"255, 85, 85\",    'class': \"ansi-bright-red\"     },\n            { color: \"0, 255, 0\",      'class': \"ansi-bright-green\"   },\n            { color: \"255, 255, 85\",   'class': \"ansi-bright-yellow\"  },\n            { color: \"85, 85, 255\",    'class': \"ansi-bright-blue\"    },\n            { color: \"255, 85, 255\",   'class': \"ansi-bright-magenta\" },\n            { color: \"85, 255, 255\",   'class': \"ansi-bright-cyan\"    },\n            { color: \"255, 255, 255\",  'class': \"ansi-bright-white\"   }\n          ]\n        ],\n\n        // 256 Colors Palette\n        PALETTE_COLORS;\n\n    function Ansi_Up() {\n      this.fg = this.bg = this.fg_truecolor = this.bg_truecolor = null;\n      this.bright = 0;\n    }\n\n    Ansi_Up.prototype.setup_palette = function() {\n      PALETTE_COLORS = [];\n      // Index 0..15 : System color\n      (function() {\n        var i, j;\n        for (i = 0; i < 2; ++i) {\n          for (j = 0; j < 8; ++j) {\n            PALETTE_COLORS.push(ANSI_COLORS[i][j]['color']);\n          }\n        }\n      })();\n\n      // Index 16..231 : RGB 6x6x6\n      // https://gist.github.com/jasonm23/2868981#file-xterm-256color-yaml\n      (function() {\n        var levels = [0, 95, 135, 175, 215, 255];\n        var format = function (r, g, b) { return levels[r] + ', ' + levels[g] + ', ' + levels[b] };\n        var r, g, b;\n        for (r = 0; r < 6; ++r) {\n          for (g = 0; g < 6; ++g) {\n            for (b = 0; b < 6; ++b) {\n              PALETTE_COLORS.push(format.call(this, r, g, b));\n            }\n          }\n        }\n      })();\n\n      // Index 232..255 : Grayscale\n      (function() {\n        var level = 8;\n        var format = function(level) { return level + ', ' + level + ', ' + level };\n        var i;\n        for (i = 0; i < 24; ++i, level += 10) {\n          PALETTE_COLORS.push(format.call(this, level));\n        }\n      })();\n    };\n\n    Ansi_Up.prototype.escape_for_html = function (txt) {\n      return txt.replace(/[&<>]/gm, function(str) {\n        if (str == \"&\") return \"&amp;\";\n        if (str == \"<\") return \"&lt;\";\n        if (str == \">\") return \"&gt;\";\n      });\n    };\n\n    Ansi_Up.prototype.linkify = function (txt) {\n      return txt.replace(/(https?:\\/\\/[^\\s]+)/gm, function(str) {\n        return \"<a href=\\\"\" + str + \"\\\">\" + str + \"</a>\";\n      });\n    };\n\n    Ansi_Up.prototype.ansi_to_html = function (txt, options) {\n      return this.process(txt, options, true);\n    };\n\n    Ansi_Up.prototype.ansi_to_text = function (txt) {\n      var options = {};\n      return this.process(txt, options, false);\n    };\n\n    Ansi_Up.prototype.process = function (txt, options, markup) {\n      var self = this;\n      var raw_text_chunks = txt.split(/\\033\\[/);\n      var first_chunk = raw_text_chunks.shift(); // the first chunk is not the result of the split\n\n      var color_chunks = raw_text_chunks.map(function (chunk) {\n        return self.process_chunk(chunk, options, markup);\n      });\n\n      color_chunks.unshift(first_chunk);\n\n      return color_chunks.join('');\n    };\n\n    Ansi_Up.prototype.process_chunk = function (text, options, markup) {\n\n      // Are we using classes or styles?\n      options = typeof options == 'undefined' ? {} : options;\n      var use_classes = typeof options.use_classes != 'undefined' && options.use_classes;\n      var key = use_classes ? 'class' : 'color';\n\n      // Each 'chunk' is the text after the CSI (ESC + '[') and before the next CSI/EOF.\n      //\n      // This regex matches four groups within a chunk.\n      //\n      // The first and third groups match code type.\n      // We supported only SGR command. It has empty first group and 'm' in third.\n      //\n      // The second group matches all of the number+semicolon command sequences\n      // before the 'm' (or other trailing) character.\n      // These are the graphics or SGR commands.\n      //\n      // The last group is the text (including newlines) that is colored by\n      // the other group's commands.\n      var matches = text.match(/^([!\\x3c-\\x3f]*)([\\d;]*)([\\x20-\\x2c]*[\\x40-\\x7e])([\\s\\S]*)/m);\n\n      if (!matches) return text;\n\n      var orig_txt = matches[4];\n      var nums = matches[2].split(';');\n\n      // We currently support only \"SGR\" (Select Graphic Rendition)\n      // Simply ignore if not a SGR command.\n      if (matches[1] !== '' || matches[3] !== 'm') {\n        return orig_txt;\n      }\n\n      if (!markup) {\n        return orig_txt;\n      }\n\n      var self = this;\n\n      while (nums.length > 0) {\n        var num_str = nums.shift();\n        var num = parseInt(num_str);\n\n        if (isNaN(num) || num === 0) {\n          self.fg = self.bg = null;\n          self.bright = 0;\n        } else if (num === 1) {\n          self.bright = 1;\n        } else if (num == 39) {\n          self.fg = null;\n        } else if (num == 49) {\n          self.bg = null;\n        } else if ((num >= 30) && (num < 38)) {\n          self.fg = ANSI_COLORS[self.bright][(num % 10)][key];\n        } else if ((num >= 90) && (num < 98)) {\n          self.fg = ANSI_COLORS[1][(num % 10)][key];\n        } else if ((num >= 40) && (num < 48)) {\n          self.bg = ANSI_COLORS[0][(num % 10)][key];\n        } else if ((num >= 100) && (num < 108)) {\n          self.bg = ANSI_COLORS[1][(num % 10)][key];\n        } else if (num === 38 || num === 48) { // extend color (38=fg, 48=bg)\n          (function() {\n            var is_foreground = (num === 38);\n            if (nums.length >= 1) {\n              var mode = nums.shift();\n              if (mode === '5' && nums.length >= 1) { // palette color\n                var palette_index = parseInt(nums.shift());\n                if (palette_index >= 0 && palette_index <= 255) {\n                  if (!use_classes) {\n                    if (!PALETTE_COLORS) {\n                      self.setup_palette.call(self);\n                    }\n                    if (is_foreground) {\n                      self.fg = PALETTE_COLORS[palette_index];\n                    } else {\n                      self.bg = PALETTE_COLORS[palette_index];\n                    }\n                  } else {\n                    var klass = (palette_index >= 16)\n                          ? ('ansi-palette-' + palette_index)\n                          : ANSI_COLORS[palette_index > 7 ? 1 : 0][palette_index % 8]['class'];\n                    if (is_foreground) {\n                      self.fg = klass;\n                    } else {\n                      self.bg = klass;\n                    }\n                  }\n                }\n              } else if(mode === '2' && nums.length >= 3) { // true color\n                var r = parseInt(nums.shift());\n                var g = parseInt(nums.shift());\n                var b = parseInt(nums.shift());\n                if ((r >= 0 && r <= 255) && (g >= 0 && g <= 255) && (b >= 0 && b <= 255)) {\n                  var color = r + ', ' + g + ', ' + b;\n                  if (!use_classes) {\n                    if (is_foreground) {\n                      self.fg = color;\n                    } else {\n                      self.bg = color;\n                    }\n                  } else {\n                    if (is_foreground) {\n                      self.fg = 'ansi-truecolor';\n                      self.fg_truecolor = color;\n                    } else {\n                      self.bg = 'ansi-truecolor';\n                      self.bg_truecolor = color;\n                    }\n                  }\n                }\n              }\n            }\n          })();\n        }\n      }\n\n      if ((self.fg === null) && (self.bg === null)) {\n        return orig_txt;\n      } else {\n        var styles = [];\n        var classes = [];\n        var data = {};\n        var render_data = function (data) {\n          var fragments = [];\n          var key;\n          for (key in data) {\n            if (data.hasOwnProperty(key)) {\n              fragments.push('data-' + key + '=\"' + this.escape_for_html(data[key]) + '\"');\n            }\n          }\n          return fragments.length > 0 ? ' ' + fragments.join(' ') : '';\n        };\n\n        if (self.fg) {\n          if (use_classes) {\n            classes.push(self.fg + \"-fg\");\n            if (self.fg_truecolor !== null) {\n              data['ansi-truecolor-fg'] = self.fg_truecolor;\n              self.fg_truecolor = null;\n            }\n          } else {\n            styles.push(\"color:rgb(\" + self.fg + \")\");\n          }\n        }\n        if (self.bg) {\n          if (use_classes) {\n            classes.push(self.bg + \"-bg\");\n            if (self.bg_truecolor !== null) {\n              data['ansi-truecolor-bg'] = self.bg_truecolor;\n              self.bg_truecolor = null;\n            }\n          } else {\n            styles.push(\"background-color:rgb(\" + self.bg + \")\");\n          }\n        }\n        if (use_classes) {\n          return '<span class=\"' + classes.join(' ') + '\"' + render_data.call(self, data) + '>' + orig_txt + '</span>';\n        } else {\n          return '<span style=\"' + styles.join(';') + '\"' + render_data.call(self, data) + '>' + orig_txt + '</span>';\n        }\n      }\n    };\n\n    // Module exports\n    ansi_up = {\n\n      escape_for_html: function (txt) {\n        var a2h = new Ansi_Up();\n        return a2h.escape_for_html(txt);\n      },\n\n      linkify: function (txt) {\n        var a2h = new Ansi_Up();\n        return a2h.linkify(txt);\n      },\n\n      ansi_to_html: function (txt, options) {\n        var a2h = new Ansi_Up();\n        return a2h.ansi_to_html(txt, options);\n      },\n\n      ansi_to_text: function (txt) {\n        var a2h = new Ansi_Up();\n        return a2h.ansi_to_text(txt);\n      },\n\n      ansi_to_html_obj: function () {\n        return new Ansi_Up();\n      }\n    };\n\n    // CommonJS module is defined\n    if (hasModule) {\n        module.exports = ansi_up;\n    }\n    /*global ender:false */\n    if (typeof window !== 'undefined' && typeof ender === 'undefined') {\n        window.ansi_up = ansi_up;\n    }\n    /*global define:false */\n    if (typeof define === \"function\" && define.amd) {\n        define(\"ansi_up\", [], function () {\n            return ansi_up;\n        });\n    }\n})(Date);\n","import ansiUp from 'ansi_up'\nimport { boldRed, boldGreen, gray } from '../lib/colors'\n\nconst { ansi_to_html: ansiToHtml, escape_for_html: escapeForHtml } = ansiUp\n\nexport default class ClientViewModel {\n  constructor (deps, parentViewModel) {\n    const { SERVER_URI, doc, win, ko, io, linkifyHtml } = deps\n    const { observable, observableArray, computed } = ko\n\n    this.window = win\n    this.linkifyHtml = linkifyHtml\n\n    // Elements\n\n    // Scrolling element is body on Webkit-based browsers,\n    // html on Firefox and Internet Explorer. All recent\n    // browsers tend to support document.scrollingElement from\n    // CSSOM working draft.\n    this.$scrollingElement = doc.scrollingElement\n    if (typeof this.$scrollingElement === 'undefined') {\n      this.$scrollingElement = doc.querySelector('html')\n    }\n\n    // Properties\n\n    this.parentViewModel = parentViewModel\n    this.socket = io.connect(SERVER_URI)\n    this.history = []\n    this.inputCallback = null\n\n    // Observables\n\n    this.lines = observableArray([])\n    this.command = observable('')\n    this.inputType = observable('text')\n    this.promptStr = observable('')\n    this.rightPromptStr = observable('')\n    this.inputHasFocus = observable(true)\n    this.loggedIn = observable(false)\n    this.playing = observable(false)\n\n    // client config\n    this.maxLines = observable(this.readConfig('maxLines') || 1000)\n    this.maxHistory = observable(this.readConfig('maxHistory') || 1000)\n    this.echo = observable(this.readConfig('echo') || false)\n    this.space = observable(this.readConfig('space') || false)\n\n    // Computeds\n\n    this.promptFormatted = computed(() => this.colorize(this.escapeHTML(this.composedPrompt())))\n    this.rightPromptFormatted = computed(() => this.colorize(this.escapeHTML(this.rightPromptStr())))\n\n    // Subscribers\n\n    this.maxLines.subscribe(max => {\n      if (this.lines().length > max) { this.truncateLines() }\n    })\n\n    this.maxHistory.subscribe(max => {\n      if (this.history().length > max) { this.truncateHistory() }\n    })\n\n    this.echo.subscribe(echo => { this.writeConfig('echo', echo) })\n    this.space.subscribe(space => { this.writeConfig('space', space) })\n\n    // Socket Setup\n\n    this.socket.on('connect', this.onConnect.bind(this))\n    this.socket.on('connecting', this.onConnecting.bind(this))\n    this.socket.on('disconnect', this.onDisconnect.bind(this))\n    this.socket.on('connect_failed', this.onConnectFailed.bind(this))\n    this.socket.on('error', this.onError.bind(this))\n    this.socket.on('reconnect_failed', this.onReconnectFailed.bind(this))\n    this.socket.on('reconnect', this.onReconnect.bind(this))\n    this.socket.on('reconnecting', this.onReconnecting.bind(this))\n    this.socket.on('output', this.onOutput.bind(this))\n    this.socket.on('set-prompt', this.onSetPrompt.bind(this))\n    this.socket.on('set-right-prompt', this.onSetRightPrompt.bind(this))\n    this.socket.on('request-input', this.onRequestInput.bind(this))\n    this.socket.on('edit-verb', this.onEditVerb.bind(this))\n    this.socket.on('edit-function', this.onEditFunction.bind(this))\n    this.socket.on('login', this.onLogin.bind(this))\n    this.socket.on('logout', this.onLogout.bind(this))\n    this.socket.on('playing', this.onPlaying.bind(this))\n    this.socket.on('quit', this.onQuit.bind(this))\n\n    this.addLine(gray('Connecting...'))\n  }\n\n  composedPrompt (optionalStr = '') {\n    return `${this.promptStr()} > ${optionalStr}`.trim()\n  }\n\n  setPrompt (str, type) {\n    this.promptStr(str)\n    if (type) { this.inputType(type) }\n  }\n\n  setRightPrompt (str) {\n    this.rightPromptStr(str)\n  }\n\n  sendCommand () {\n    const command = this.command().trim()\n\n    if (!command) { return }\n\n    this.echoCommand(command)\n    this.addToHistory(command)\n\n    if (this.handleClientCommand(command)) {\n      // done, client handled command\n    } else if (!this.socket.connected) {\n      this.addLine(boldRed('Not connected.'))\n    } else if (this.inputCallback) {\n      this.handleInputCallback(command)\n    } else {\n      this.socket.emit('input', command)\n    }\n\n    this.command('')\n  }\n\n  echoCommand (command) {\n    if (!this.echo() || this.inputType() === 'password') { return }\n    this.addLine(this.composedPrompt(command))\n    if (this.space()) { this.addLine(' ') }\n  }\n\n  addToHistory (command) {\n    if (this.inputType() === 'password') { return }\n    this.history.unshift(command)\n    if (this.history.length > this.maxHistory()) { this.truncateHistory() }\n    this.currentHistory = -1\n  }\n\n  handleClientCommand (command) {\n    switch (command) {\n      case '.clear': this.lines([]); return true\n      case '.connect': this.reconnectSocket(); return true\n      case '.disconnect': this.disconnectSocket(); return true\n      case '.echo on': this.echo(true); return true\n      case '.echo off': this.echo(false); return true\n      case '.space on': this.space(true); return true\n      case '.space off': this.space(false); return true\n      case '.new tab': this.parentViewModel.parentViewModel.newClientTab(); return true\n      case '.close tab': this.parentViewModel.close(); return true\n      default: return false\n    }\n  }\n\n  handleInputCallback (command) {\n    const callback = this.inputCallback\n    this.inputCallback = null\n    callback(command)\n  }\n\n  addLine (line) {\n    this.lines.push(this.colorize(this.escapeHTML(line)))\n    this.scrollToBottom()\n  }\n\n  disconnectSocket () {\n    if (this.socket.connected) {\n      this.socket.disconnect()\n    } else {\n      this.addLine(boldRed('Not connected.'))\n    }\n  }\n\n  reconnectSocket () {\n    if (this.socket.connected) {\n      this.addLine(boldRed('Already connected.'))\n    } else {\n      this.socket.connect()\n    }\n  }\n\n  scrollToBottom () {\n    this.$scrollingElement.scrollTop =\n      this.$scrollingElement.scrollHeight - this.window.innerHeight\n  }\n\n  truncateHistory () {\n    this.history = this.history.slice(0, this.maxHistory())\n  }\n\n  truncateLines () {\n    const lengthDiff = this.lines().length - this.maxLines()\n    this.lines(this.lines.slice(lengthDiff))\n  }\n\n  willClose () {\n    this.socket.disconnect()\n    return true\n  }\n\n  // Event handlers\n\n  onKeyDown (_, event) {\n    const key = typeof event.which === 'undefined' ? event.keyCode : event.which\n    const meta = event.metaKey\n    const ctrl = event.ctrlKey\n    const shift = event.shiftKey\n    const vKey = key === 86\n    const upKey = key === 38\n    const downKey = key === 40\n    const tabKey = key === 9\n\n    // if holding control or command and not trying to paste,\n    // ignore this keypress\n    if ((meta && !vKey) || (ctrl && !vKey)) {\n      return true\n    }\n\n    // otherwise, re-focus the input before the key is let up\n    if (!this.inputHasFocus()) {\n      this.inputHasFocus(true)\n      // when hitting up or down and not focused,\n      // the keydown event doesn't get passed on\n      if (upKey || downKey) {\n        // HACK fake event object\n        return this.onRecall(null, { which: key })\n      }\n    }\n\n    if (tabKey) {\n      const direction = shift ? -1 : 1\n      this.socket.emit('tab-key-press', { direction })\n      return false\n    }\n\n    return true\n  }\n\n  onClick (_, event) {\n    if (event.target && event.target.hash) {\n      const pattern = /#cmd\\[(.*?)]/g\n      const match = pattern.exec(event.target.hash)\n      if (!match) { return true }\n      const command = decodeURIComponent(match[1]) // URI-encoded on some browsers (e.g. Firefox)\n      this.command(command)\n      this.sendCommand()\n      return false\n    }\n    return true\n  }\n\n  onRecall (_, event) {\n    const key = typeof event.which === 'undefined' ? event.keyCode : event.which\n    if (this.history.length === 0) { return true }\n    switch (key) {\n      case 38: { // up key\n        if (this.currentHistory < this.history.length - 1) {\n          this.currentHistory += 1\n        }\n        this.command(this.history[this.currentHistory])\n        return false\n      }\n      case 40: { // down key\n        if (this.currentHistory > -1) {\n          this.currentHistory -= 1\n        }\n        if (this.currentHistory >= 0) {\n          this.command(this.history[this.currentHistory])\n        } else {\n          this.command('')\n        }\n        break\n      }\n      default: {\n        break\n      }\n    }\n    return true\n  }\n\n  // Socket event handlers\n\n  onConnect () { this.addLine(boldGreen('Connected!')) }\n  onConnecting () { this.addLine(gray('Connecting...')) }\n\n  onDisconnect () {\n    this.addLine(boldRed('Disconnected from server.'))\n    this.setPrompt('')\n    this.inputCallback = null\n    this.loggedIn(false)\n    this.playing(false)\n  }\n\n  onConnectFailed () { this.addLine(boldRed('Connection to server failed.')) }\n  onError () { this.addLine(boldRed('An unknown error occurred.')) }\n  onReconnectFailed () { this.addLine(boldRed('Unable to reconnect to server.')) }\n  onReconnect () {}\n  onReconnecting () {}\n\n  onOutput (msg) {\n    if (msg && msg.toString) {\n      this.addLine(msg.toString())\n      if (this.space()) { this.addLine(' ') }\n    }\n  }\n\n  onSetPrompt (str) {\n    this.setPrompt(str)\n  }\n\n  onSetRightPrompt (str) {\n    this.setRightPrompt(str)\n  }\n\n  onEditVerb (data) {\n    this.parentViewModel.parentViewModel.newEditVerbTab(this.socket, data)\n  }\n\n  onEditFunction (data) {\n    this.parentViewModel.parentViewModel.newEditFunctionTab(this.socket, data)\n  }\n\n  onLogin () {\n    this.loggedIn(true)\n  }\n\n  onLogout () {\n    this.loggedIn(false)\n  }\n\n  onPlaying () {\n    this.playing(true)\n  }\n\n  onQuit () {\n    this.playing(false)\n  }\n\n  onRequestInput (inputs, fn) {\n    const promptWas = this.promptStr()\n    this.getInputFromUser({}, inputs, formData => {\n      this.setPrompt(promptWas, 'text')\n      fn(formData)\n    })\n  }\n\n  // Helpers for the above\n\n  getInputFromUser (data, inputs, done) {\n    if (inputs.length === 0) { done(data); return }\n\n    const [input, ...restInputs] = inputs\n\n    this.setPrompt(input.label || 'input', input.type || 'text')\n\n    this.inputCallback = userInput => {\n      data[input.name || 'input'] = userInput\n      this.getInputFromUser(data, restInputs, done)\n    }\n  }\n\n  // Local storage helpers\n\n  readConfig (key) {\n    return this.window.localStorage ? JSON.parse(this.window.localStorage.getItem(key)) : null\n  }\n\n  writeConfig (key, value) {\n    if (this.window.localStorage) {\n      this.window.localStorage.setItem(key, JSON.stringify(value))\n    }\n  }\n\n  // Color and HTML helpers\n\n  linkifyCommands (str) {\n    const pattern = /#cmd\\[(.*?)]/g\n    return str.replace(pattern, (match, capture) => `<a href='${match}'>${capture}</a>`)\n  }\n\n  colorize (str) {\n    return this.linkifyCommands(this.linkifyHtml(ansiToHtml(str, { use_classes: true })))\n  }\n\n  escapeHTML (str) {\n    return escapeForHtml(str)\n  }\n}\n","import ClientViewModel from './client-view-model'\n\nexport default class ClientTabViewModel {\n  constructor (deps, parentViewModel) {\n    const { ko } = deps\n\n    // Properties\n\n    this.parentViewModel = parentViewModel\n    this.templateId = 'client'\n    this.viewModel = new ClientViewModel(deps, this)\n    this.dirty = false\n\n    // Observables\n\n    this.name = ko.observable('Room.js')\n\n    // Computeds\n\n    this.active = ko.computed(this.computeActive.bind(this))\n  }\n\n  templateBinding () {\n    return { name: this.templateId, data: this.viewModel }\n  }\n\n  computeActive () {\n    return this.parentViewModel.activeTab() === this\n  }\n\n  select () {\n    this.parentViewModel.activeTab(this)\n    this.viewModel.scrollToBottom()\n    this.viewModel.inputHasFocus(true)\n  }\n\n  close () {\n    if (this.viewModel.willClose()) {\n      this.parentViewModel.closeTab(this)\n    }\n  }\n\n  tabPaneClasses () {\n    return ['tab-pane-client']\n  }\n\n  hideIfOnlyMe () {\n    return true\n  }\n}\n","export default class VerbEditorViewModel {\n  constructor ({ ko, CodeMirror, win }, parentViewModel, socket, { verb, objectId }) {\n    // Properties\n\n    this.window = win\n    this.parentViewModel = parentViewModel\n    this.socket = socket\n    this.objectId = objectId\n    this.name = verb.name\n    this.codemirrorOptions = {\n      lineNumbers: true,\n      theme: 'tomorrow-night-bright',\n      tabSize: 2,\n      indentWithTabs: false,\n      extraKeys: {\n        Tab: cm => {\n          if (cm.doc.somethingSelected()) {\n            return CodeMirror.Pass\n          }\n          return cm.execCommand('insertSoftTab')\n        }\n      }\n    }\n\n    // Observables\n\n    this.pattern = ko.observable(verb.pattern)\n    this.dobjarg = ko.observable(verb.dobjarg)\n    this.preparg = ko.observable(verb.preparg)\n    this.iobjarg = ko.observable(verb.iobjarg)\n    this.code = ko.observable(verb.code)\n\n    // for dirty tracking\n    this._pattern = ko.observable(verb.pattern)\n    this._dobjarg = ko.observable(verb.dobjarg)\n    this._preparg = ko.observable(verb.preparg)\n    this._iobjarg = ko.observable(verb.iobjarg)\n    this._code = ko.observable(verb.code)\n\n    // Computeds\n\n    this.dirty = ko.computed(this.computeDirty.bind(this))\n  }\n\n  computeDirty () {\n    return this.pattern() !== this._pattern() ||\n           this.dobjarg() !== this._dobjarg() ||\n           this.preparg() !== this._preparg() ||\n           this.iobjarg() !== this._iobjarg() ||\n           this.code() !== this._code()\n  }\n\n  save () {\n    const newVerb = {\n      name: this.name,\n      pattern: this.pattern(),\n      dobjarg: this.dobjarg(),\n      preparg: this.preparg(),\n      iobjarg: this.iobjarg(),\n      code: this.code()\n    }\n    const params = {\n      objectId: this.objectId,\n      verb: newVerb\n    }\n\n    if (!this.socket.connected) {\n      // eslint-disable-next-line no-alert\n      this.window.alert([\n        'The client tab that this editor was opened from has been',\n        'closed.  You must keep that open for saving to work.'\n      ].join(' '))\n      return\n    }\n\n    this.socket.emit('save-verb', params, response => {\n      if (response === 'saved') {\n        this._pattern(this.pattern())\n        this._dobjarg(this.dobjarg())\n        this._preparg(this.preparg())\n        this._iobjarg(this.iobjarg())\n        this._code(this.code())\n      } else {\n        // eslint-disable-next-line no-alert\n        this.window.alert(response)\n      }\n    })\n  }\n\n  willClose () {\n    const msg = [\n      'Are you sure you want to close this tab?',\n      'You have unsaved changes that will be lost.'\n    ].join(' ')\n\n    return this.dirty()\n      // eslint-disable-next-line no-alert\n      ? this.window.confirm(msg)\n      : true\n  }\n\n  onKeyDown (_, event) {\n    const key = typeof event.which === 'undefined' ? event.keyCode : event.which\n    const meta = event.metaKey\n    const ctrl = event.ctrlKey\n    const sKey = key === 83\n    const wKey = key === 87\n\n    if ((ctrl && sKey) || (meta && sKey)) {\n      this.save()\n      return false\n    } else if ((ctrl && wKey) || (meta && wKey)) {\n      // this would be nice, but this is one shortcut you can't override...\n      this.parentViewModel.close()\n      return false\n    }\n    return true\n  }\n}\n","import VerbEditorViewModel from './verb-editor-view-model'\n\nexport default class VerbEditorTabViewModel {\n  constructor (deps, parentViewModel, socket, data) {\n    const { ko } = deps\n\n    // Properties\n\n    this.parentViewModel = parentViewModel\n    this.templateId = 'verb-editor'\n    this.viewModel = new VerbEditorViewModel(deps, this, socket, data)\n\n    // Observables\n\n    this.name = ko.observable(VerbEditorTabViewModel.tabName(data))\n\n    // Computeds\n\n    this.active = ko.computed(() => parentViewModel.activeTab() === this)\n    this.dirty = ko.computed(() => this.viewModel.dirty())\n  }\n\n  templateBinding () {\n    return { name: this.templateId, data: this.viewModel }\n  }\n\n  select () {\n    this.parentViewModel.activeTab(this)\n  }\n\n  close () {\n    if (this.viewModel.willClose()) {\n      this.parentViewModel.closeTab(this)\n    }\n  }\n\n  tabPaneClasses () {\n    return ['tab-pane-editor', 'tab-pane-verb-editor']\n  }\n\n  hideIfOnlyMe () {\n    return false\n  }\n\n  static tabName (data) {\n    return `${data.objectId}.${data.verb.name}`\n  }\n}\n","export default class FunctionEditorViewModel {\n  constructor ({ ko, CodeMirror, win }, parentViewModel, socket, { objectId, src, name }) {\n    // Properties\n\n    this.window = win\n    this.parentViewModel = parentViewModel\n    this.socket = socket\n    this.objectId = objectId\n    this.src = src\n    this.name = name\n    this.codemirrorOptions = {\n      lineNumbers: true,\n      theme: 'tomorrow-night-bright',\n      tabSize: 2,\n      indentWithTabs: false,\n      extraKeys: {\n        Tab: cm => {\n          if (cm.doc.somethingSelected()) {\n            return CodeMirror.Pass\n          }\n          return cm.execCommand('insertSoftTab')\n        }\n      }\n    }\n\n    // Observables\n\n    this.code = ko.observable(this.src)\n    this._code = ko.observable(this.src)\n\n    // Computeds\n\n    this.dirty = ko.computed(() => this.code() !== this._code())\n  }\n\n  save () {\n    const params = {\n      name: this.name,\n      src: this.code(),\n      objectId: this.objectId\n    }\n\n    if (!this.socket.connected) {\n      // eslint-disable-next-line no-alert\n      this.window.alert([\n        'The client tab that this editor was opened from has been',\n        'closed.  You must keep that open for saving to work.'\n      ].join(' '))\n      return\n    }\n\n    this.socket.emit('save-function', params, response => {\n      if (response === 'saved') {\n        this._code(this.code())\n      } else {\n        // eslint-disable-next-line no-alert\n        this.window.alert(response)\n      }\n    })\n  }\n\n  willClose () {\n    const msg = [\n      'Are you sure you want to close this tab?',\n      'You have unsaved changes that will be lost.'\n    ].join(' ')\n\n    return this.dirty()\n      // eslint-disable-next-line no-alert\n      ? this.window.confirm(msg)\n      : true\n  }\n\n  onKeyDown (_, event) {\n    const key = typeof event.which === 'undefined' ? event.keyCode : event.which\n    const meta = event.metaKey\n    const ctrl = event.ctrlKey\n    const sKey = key === 83\n    const wKey = key === 87\n\n    if ((ctrl && sKey) || (meta && sKey)) {\n      this.save()\n      return false\n    } else if ((ctrl && wKey) || (meta && wKey)) {\n      // this would be nice, but this is one shortcut you can't override...\n      this.parentViewModel.close()\n      return false\n    }\n    return true\n  }\n}\n","import FunctionEditorViewModel from './function-editor-view-model'\n\nexport default class FunctionEditorTabViewModel {\n  constructor (deps, parentViewModel, socket, data) {\n    const { ko } = deps\n\n    // Properties\n\n    this.parentViewModel = parentViewModel\n    this.templateId = 'function-editor'\n    this.viewModel = new FunctionEditorViewModel(deps, this, socket, data)\n\n    // Observables\n\n    this.name = ko.observable(FunctionEditorTabViewModel.tabName(data))\n\n    // Computeds\n\n    this.active = ko.computed(() => parentViewModel.activeTab() === this)\n    this.dirty = ko.computed(() => this.viewModel.dirty())\n  }\n\n  templateBinding () {\n    return { name: this.templateId, data: this.viewModel }\n  }\n\n  select () {\n    this.parentViewModel.activeTab(this)\n  }\n\n  close () {\n    if (this.viewModel.willClose()) {\n      this.parentViewModel.closeTab(this)\n    }\n  }\n\n  tabPaneClasses () {\n    return ['tab-pane-editor', 'tab-pane-function-editor']\n  }\n\n  hideIfOnlyMe () {\n    return false\n  }\n\n  static tabName (data) {\n    return `${data.objectId}.${data.name}`\n  }\n}\n","import ClientTabViewModel from './client-tab-view-model'\nimport VerbEditorTabViewModel from './verb-editor-tab-view-model'\nimport FunctionEditorTabViewModel from './function-editor-tab-view-model'\nimport SearchViewModel from './search-view-model'\n\nexport default class TabsViewModel {\n  constructor (deps) {\n    const { ko } = deps\n    this.deps = deps\n\n    // Observables\n\n    this.activeTab = ko.observable()\n    this.tabs = ko.observableArray([])\n    this.searchViewModel = ko.observable()\n\n    // Computeds\n\n    this.activeViewModel = ko.computed(this.computeActiveViewModel.bind(this))\n    this.hidden = ko.computed(this.computeHidden.bind(this))\n    this.visible = ko.computed(this.computeVisible.bind(this))\n    this.tabPaneClasses = ko.computed(this.computeTabPaneClasses.bind(this))\n    this.templateBinding = ko.computed(this.computeTemplateBinding.bind(this))\n    this.activeSocket = ko.computed(this.computeActiveSocket.bind(this))\n    this.anyTabLoggedIn = ko.computed(this.computedAnyTabLoggedIn.bind(this))\n\n    // Initialization\n\n    this.activeTab(this.tabs()[0])\n  }\n\n  computeActiveViewModel () {\n    const searchViewModel = this.searchViewModel()\n    if (searchViewModel) {\n      return searchViewModel\n    }\n    const activeTab = this.activeTab()\n    return activeTab ? activeTab.viewModel : this\n  }\n\n  computeHidden () {\n    const l = this.tabs().length\n    const t = this.tabs()[0]\n\n    return l === 0 || (l === 1 && t.hideIfOnlyMe())\n  }\n\n  computeVisible () {\n    return !this.hidden()\n  }\n\n  computeTabPaneClasses () {\n    const activeTab = this.activeTab()\n    let classes\n\n    if (activeTab) {\n      classes = activeTab.tabPaneClasses()\n    } else {\n      classes = []\n    }\n\n    if (this.visible()) {\n      classes.push('tabs-visible')\n    }\n\n    return classes.join(' ')\n  }\n\n  computeTemplateBinding () {\n    const activeTab = this.activeTab()\n    if (activeTab) {\n      return activeTab.templateBinding()\n    }\n    return { name: 'no-tabs', data: this }\n  }\n\n  computeActiveSocket () {\n    const activeViewModel = this.activeViewModel()\n    return activeViewModel.socket\n  }\n\n  computedAnyTabLoggedIn () {\n    return this.tabs().reduce((result, tab) =>\n      result || (tab.viewModel && tab.viewModel.loggedIn && tab.viewModel.loggedIn())\n    , false)\n  }\n\n  tabPaneClasses () {\n    return []\n  }\n\n  newClientTab () {\n    this.addAndSelectTab(new ClientTabViewModel(this.deps, this))\n  }\n\n  newEditVerbTab (...args) {\n    this.newEditTab(VerbEditorTabViewModel, ...args)\n  }\n\n  newEditFunctionTab (...args) {\n    this.newEditTab(FunctionEditorTabViewModel, ...args)\n  }\n\n  newEditTab (EditorTabViewModel, socket, data) {\n    const tabName = EditorTabViewModel.tabName(data)\n\n    if (this.selectExistingTab(tabName)) {\n      return\n    }\n\n    this.addAndSelectTab(new EditorTabViewModel(this.deps, this, socket, data))\n  }\n\n  addAndSelectTab (tab) {\n    this.tabs.push(tab)\n    tab.select()\n  }\n\n  selectExistingTab (name) {\n    let selected = false\n\n    this.tabs().forEach(tab => {\n      if (tab.name() === name) {\n        tab.select()\n        selected = true\n      }\n    })\n\n    return selected\n  }\n\n  closeTab (tab) {\n    const l = this.tabs().length - 1\n    let i = this.tabs.indexOf(tab)\n\n    if (i === l) { i -= 1 }\n    this.tabs.remove(tab)\n    if (l > 0) {\n      this.tabs()[i].select()\n    } else {\n      this.activeTab(null)\n    }\n  }\n\n  closeSameTabs (tab) {\n    // Close other tabs with same names, only if they are not edited\n    this.tabs().forEach(t => {\n      if (t.name() === tab.name() && !t.dirty()) {\n        this.closeTab(t)\n      }\n    })\n  }\n\n  onKeyDown (...args) {\n    const event = args[1]\n    const activeViewModel = this.activeViewModel()\n    const key = typeof event.which === 'undefined' ? event.keyCode : event.which\n    const meta = event.metaKey\n    const ctrl = event.ctrlKey\n    const pKey = key === 80\n\n    // open the search box on cmd+p (or ctrl+p) if it's not already open\n    if ((meta && pKey) || (ctrl && pKey)) {\n      if (!this.searchViewModel()) {\n        this.searchViewModel(new SearchViewModel(this.deps, this, this.activeSocket()))\n      }\n      return false\n    }\n\n    if (activeViewModel !== this && activeViewModel.onKeyDown) {\n      return activeViewModel.onKeyDown(...args)\n    }\n    return true\n  }\n\n  onKeyUp (...args) {\n    const activeViewModel = this.activeViewModel()\n\n    if (activeViewModel !== this && activeViewModel.onKeyUp) {\n      return activeViewModel.onKeyUp(...args)\n    }\n    return true\n  }\n}\n"],"names":["register","ko","CodeMirror","init","element","valueAccessor","allBindings","options","get","value","unwrap","editor","on","cm","getValue","update","observedValue","setValue","refresh","bindingHandlers","codemirror","classList","remove","uncloak","boldRed","str","boldGreen","gray","isElementVisibleIn","el","container","elRect","getBoundingClientRect","containerRect","top","left","bottom","right","addSaneOnUnloadHandler","win","promptBeforeLeaving","alreadPrompted","timeoutID","reset","onbeforeunload","setTimeout","NAVIGATE_AWAY_MESSAGE","onunload","Date","undefined","Ansi_Up","fg","this","bg","fg_truecolor","bg_truecolor","bright","ansi_up","color","class","prototype","setup_palette","i","j","push","ANSI_COLORS","r","g","b","levels","format","call","level","escape_for_html","txt","replace","linkify","ansi_to_html","process","ansi_to_text","markup","self","raw_text_chunks","split","first_chunk","shift","color_chunks","map","chunk","process_chunk","unshift","join","text","use_classes","key","matches","match","orig_txt","nums","length","num_str","num","parseInt","isNaN","is_foreground","mode","palette_index","klass","PALETTE_COLORS","styles","classes","data","render_data","fragments","hasOwnProperty","window","ender","ansiToHtml","ansiUp","escapeForHtml","ClientViewModel","deps","parentViewModel","SERVER_URI","doc","io","linkifyHtml","observable","observableArray","computed","$scrollingElement","scrollingElement","querySelector","socket","connect","history","inputCallback","lines","command","inputType","promptStr","rightPromptStr","inputHasFocus","loggedIn","playing","maxLines","readConfig","maxHistory","echo","space","promptFormatted","_this","colorize","escapeHTML","composedPrompt","rightPromptFormatted","subscribe","max","truncateLines","truncateHistory","writeConfig","onConnect","bind","onConnecting","onDisconnect","onConnectFailed","onError","onReconnectFailed","onReconnect","onReconnecting","onOutput","onSetPrompt","onSetRightPrompt","onRequestInput","onEditVerb","onEditFunction","onLogin","onLogout","onPlaying","onQuit","addLine","optionalStr","trim","type","echoCommand","addToHistory","handleClientCommand","connected","handleInputCallback","emit","currentHistory","reconnectSocket","disconnectSocket","newClientTab","close","callback","line","scrollToBottom","disconnect","scrollTop","scrollHeight","innerHeight","slice","lengthDiff","_","event","which","keyCode","meta","metaKey","ctrl","ctrlKey","shiftKey","vKey","upKey","downKey","tabKey","onRecall","direction","target","hash","exec","decodeURIComponent","sendCommand","setPrompt","msg","toString","setRightPrompt","newEditVerbTab","newEditFunctionTab","inputs","fn","promptWas","getInputFromUser","formData","done","input","restInputs","label","name","userInput","localStorage","JSON","parse","getItem","setItem","stringify","pattern","capture","linkifyCommands","ClientTabViewModel","templateId","viewModel","dirty","active","computeActive","activeTab","willClose","closeTab","VerbEditorViewModel","verb","objectId","codemirrorOptions","somethingSelected","Pass","execCommand","dobjarg","preparg","iobjarg","code","_pattern","_dobjarg","_preparg","_iobjarg","_code","computeDirty","newVerb","params","response","alert","confirm","sKey","wKey","save","VerbEditorTabViewModel","tabName","FunctionEditorViewModel","src","_this2","FunctionEditorTabViewModel","SearchResult","computeName","Error","result","function","FunctionSearchResult","VerbSearchResult","tabsViewModel","SearchViewModel","document","search","results","selectedIndex","selectionDirection","onSearch","activeResult","computeActiveResult","hasResults","_this3","forEach","scrollActiveResultIntoView","scrollIntoView","searchViewModel","openEditor","newFromResult","_this4","openActiveResult","TabsViewModel","tabs","activeViewModel","computeActiveViewModel","hidden","computeHidden","visible","computeVisible","tabPaneClasses","computeTabPaneClasses","templateBinding","computeTemplateBinding","activeSocket","computeActiveSocket","anyTabLoggedIn","computedAnyTabLoggedIn","l","t","hideIfOnlyMe","reduce","tab","addAndSelectTab","args","newEditTab","EditorTabViewModel","selectExistingTab","select","selected","indexOf","pKey","onKeyDown","onKeyUp"],"mappings":"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"}